import{w as g,g as m}from"./D5sqcERo.js";import{n as f,i as h}from"./3qLZv7Rd.js";const C=["dashboard","usuarios","clientes","roles","modulos","vehiculos","conductores","trayectos","asignaciones","registroHoras"],R=["ver","crear","editar","eliminar","desactivar"],l={ADMINISTRADOR:Object.fromEntries(C.map(e=>[e,{sidebar:!0,acciones:Object.fromEntries(R.map(a=>[a,!0]))}])),COORDINADOR:{dashboard:{sidebar:!0,acciones:{ver:!0,crear:!0,editar:!1,eliminar:!1,desactivar:!1}},usuarios:{sidebar:!0,acciones:{ver:!0,crear:!0,editar:!1,eliminar:!1,desactivar:!1}},clientes:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},roles:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},modulos:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},vehiculos:{sidebar:!0,acciones:{ver:!0,crear:!0,editar:!1,eliminar:!1,desactivar:!1}},conductores:{sidebar:!0,acciones:{ver:!0,crear:!0,editar:!1,eliminar:!1,desactivar:!1}},trayectos:{sidebar:!0,acciones:{ver:!0,crear:!0,editar:!1,eliminar:!1,desactivar:!1}},asignaciones:{sidebar:!0,acciones:{ver:!0,crear:!0,editar:!1,eliminar:!1,desactivar:!1}},registroHoras:{sidebar:!0,acciones:{ver:!0,crear:!0,editar:!1,eliminar:!1,desactivar:!1}}},HSEQ:{dashboard:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},usuarios:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},clientes:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},roles:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},modulos:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},vehiculos:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},conductores:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},trayectos:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},asignaciones:{sidebar:!1,acciones:{ver:!1,crear:!1,editar:!1,eliminar:!1,desactivar:!1}},registroHoras:{sidebar:!0,acciones:{ver:!0,crear:!0,editar:!1,eliminar:!1,desactivar:!1}}}};function O(e={}){const a=e.acciones||{};return{sidebar:e.sidebar===!0,acciones:Object.fromEntries(R.map(r=>[r,a[r]===!0]))}}function v(e,a={}){const r=l[e]||{};return Object.fromEntries(C.map(s=>{const t=a[s]||r[s]||{sidebar:!1,acciones:{}};return[s,O(t)]}))}function o(e={}){const a=Object.keys({...l,...e});return Object.fromEntries(a.map(r=>{const s=r.toUpperCase();return[s,v(s,e[r]||{})]}))}const i=g(o(l)),c=g(!1);async function E(){c.set(!0);try{const e=await f.listar(),a=o(e.config||{});return i.set(a),a}catch(e){return console.warn("No se pudo obtener configuración de módulos, usando defaults:",e),i.set(o(l)),m(i)}finally{c.set(!1)}}async function M(e){const a=(e||"").toUpperCase();if(!a)return null;c.set(!0);try{const r=await f.obtenerPorRol(a),s=o({[a]:r.permisos||{}});return i.update(t=>({...t,...s})),s[a]}catch(r){throw console.warn(`No se pudo obtener permisos para el rol ${a}`,r),r}finally{c.set(!1)}}async function I(e,a){const r=(e||"").toUpperCase();if(!r)throw new Error("Rol requerido");const s=v(r,a||{});return i.update(t=>({...t,[r]:s})),await f.actualizarRol(r,s),s}async function S(){c.set(!0);try{const e=await f.reset(),a=o(e.config||{});return i.set(a),a}catch(e){throw i.set(o(l)),e}finally{c.set(!1)}}function A(e){return m(i)?.[(e||"").toUpperCase()]||v((e||"").toUpperCase(),{})}function y(e,a){const r=(a||"").toUpperCase(),t=A(r)?.[e];return t?.sidebar===!0&&t?.acciones?.ver===!0}function w(e,a,r){const s=(r||"").toUpperCase(),b=A(s)?.[e];return b?b.acciones?.[a]===!0:!1}function N(){return l}function u(){return m(h)?.usuario?.nombre_rol?.toUpperCase()||null}function p(){return u()==="ADMINISTRADOR"}function j(e){if(e)return d(e,"crear");const a=u();return a==="ADMINISTRADOR"||a==="COORDINADOR"}function z(e){return e?d(e,"editar"):p()}function H(e){return e?d(e,"eliminar"):p()}function T(e){return e?d(e,"desactivar"):p()}function n(e){const a=u();return a?y(e,a):!1}function d(e,a){const r=u();return r?w(e,a,r):!1}function k(){return n("usuarios")}function V(){return n("vehiculos")}function q(){return n("conductores")}function $(){return n("trayectos")}function x(){return n("asignaciones")}function B(){return n("roles")}function F(){return n("clientes")}function L(){return n("registroHoras")}export{R as A,C as M,n as a,d as b,j as c,z as d,T as e,E as f,u as g,N as h,A as i,c as j,I as k,M as l,i as m,B as n,F as o,H as p,V as q,S as r,q as s,k as t,$ as u,x as v,L as w};
