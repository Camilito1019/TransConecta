import"../chunks/DsnmJJEf.js";import"../chunks/2J32lFCu.js";import{o as aa,a as l,e as ea}from"../chunks/D5sqcERo.js";import{at as sa,aq as P,aw as G,a as C,ax as ra,r as oa,ar as e,az as i,s as u,W as $,ay as ta,as as s,b as t,f as ia,aB as R}from"../chunks/DdWuALZu.js";import{i as va}from"../chunks/DNIL3y1X.js";import{h as la}from"../chunks/CgsUcASs.js";import{r as q}from"../chunks/DjPkcCDc.js";import{b as A}from"../chunks/CnWbZhhT.js";import{i as ua}from"../chunks/-w5iKcy_.js";import{s as na,a as ca}from"../chunks/B3jtdlFh.js";import{i as pa,j as B,s as I,b as p}from"../chunks/3qLZv7Rd.js";var da=P('<div class="loading svelte-x3vgov"><div class="spinner svelte-x3vgov"></div> <p>Cargando tu perfil...</p></div>'),ma=P('<div class="form-grid svelte-x3vgov"><label class="field svelte-x3vgov"><span>Nombre</span> <input type="text" placeholder="Tu nombre" autocomplete="name" class="svelte-x3vgov"/></label> <label class="field svelte-x3vgov"><span>Correo</span> <input type="email" placeholder="correo@ejemplo.com" autocomplete="email" class="svelte-x3vgov"/></label></div> <div class="actions svelte-x3vgov"><button type="button" class="primary svelte-x3vgov"> </button></div>',1),fa=P('<div class="profile-shell svelte-x3vgov"><div class="bg shape-a svelte-x3vgov" aria-hidden="true"></div> <div class="bg shape-b svelte-x3vgov" aria-hidden="true"></div> <section class="profile-card svelte-x3vgov"><header class="profile-head svelte-x3vgov"><div class="avatar svelte-x3vgov"> </div> <div class="head-text svelte-x3vgov"><p class="eyebrow svelte-x3vgov">Cuenta</p> <h1 class="svelte-x3vgov">Mi Perfil</h1> <p class="lede svelte-x3vgov">Revisa y actualiza tus datos personales.</p> <div class="chips svelte-x3vgov"><span class="chip svelte-x3vgov"> </span> <span class="chip soft svelte-x3vgov"> </span> <span class="chip state svelte-x3vgov"> </span></div></div></header> <!></section></div>');function Na(S,W){sa(W,!1);const v=()=>ca(pa,"$auth",D),[D,E]=na();let d=$(!0),n=$(!1),o=$({nombre_usuario:"",correo:""});const F=a=>a?a.split(" ").map(r=>r[0]).join("").substring(0,2).toUpperCase():"TC";aa(()=>{H()});async function H(){u(d,!0);try{const a=await B.me();a?.usuario&&(I(a.usuario),u(o,{nombre_usuario:a.usuario.nombre_usuario||"",correo:a.usuario.correo||""}))}catch(a){p(a.message||"No se pudo cargar el perfil","error")}finally{u(d,!1)}}async function J(){if(!t(o).nombre_usuario||!t(o).correo){p("Nombre y correo son obligatorios","warning");return}u(n,!0);try{const a={nombre_usuario:t(o).nombre_usuario,correo:t(o).correo},r=await B.actualizarPerfil(a);r?.usuario&&I(r.usuario),p(r?.mensaje||"Perfil actualizado","success")}catch(a){p(a.message||"No se pudo actualizar el perfil","error")}finally{u(n,!1)}}ua();var m=fa();la("x3vgov",a=>{oa(()=>{ta.title="Mi Perfil - TransConecta"})});var w=i(e(m),4),f=e(w),g=e(f),K=e(g,!0);s(g);var z=i(g,2),N=i(e(z),6),_=e(N),L=e(_,!0);s(_);var b=i(_,2),O=e(b,!0);s(b);var j=i(b,2),Q=e(j,!0);s(j),s(N),s(z),s(f);var V=i(f,2);{var X=a=>{var r=da();C(a,r)},Y=a=>{var r=ma(),x=ia(r),h=e(x),M=i(e(h),2);q(M),s(h);var T=i(h,2),U=i(e(T),2);q(U),s(T),s(x);var k=i(x,2),c=e(k),Z=e(c,!0);s(c),s(k),G(()=>{c.disabled=t(n),l(Z,t(n)?"Guardando...":"Guardar cambios")}),A(M,()=>t(o).nombre_usuario,y=>R(o,t(o).nombre_usuario=y)),A(U,()=>t(o).correo,y=>R(o,t(o).correo=y)),ea("click",c,J),C(a,r)};va(V,a=>{t(d)?a(X):a(Y,!1)})}s(w),s(m),G((a,r)=>{l(K,a),l(L,v().usuario?.correo||"correo@dominio.com"),l(O,v().nombre_rol||v().usuario?.nombre_rol||"Rol"),l(Q,r)},[()=>F(v().usuario?.nombre_usuario),()=>(v().usuario?.estado||"activo").toUpperCase()]),C(S,m),ra(),E()}export{Na as component};
