import"../chunks/DsnmJJEf.js";import"../chunks/2J32lFCu.js";import{at as la,aq as x,aw as na,b as a,a as y,ax as va,r as pa,ar as e,ay as ca,az as r,as as t,W as v,s as o}from"../chunks/DdWuALZu.js";import{e as w,a as g}from"../chunks/D5sqcERo.js";import{i as K}from"../chunks/DNIL3y1X.js";import{h as ua}from"../chunks/CgsUcASs.js";import{r as P,s as T}from"../chunks/DjPkcCDc.js";import{b as E}from"../chunks/CnWbZhhT.js";import{p as da}from"../chunks/CdEA5IGF.js";import{i as ma}from"../chunks/-w5iKcy_.js";import{s as ba,a as fa}from"../chunks/B3jtdlFh.js";import{i as O,b,u as _a}from"../chunks/3qLZv7Rd.js";import{g as ha}from"../chunks/C07Td5iz.js";var ya=x('<p class="subtitle required svelte-t4vsop">⚠️ Debes cambiar tu contraseña temporal antes de continuar</p>'),wa=x('<p class="subtitle svelte-t4vsop">Actualiza tu clave con el mismo estilo del login.</p>'),ga=x('<div class="warning-box svelte-t4vsop"><span class="ms-icon svelte-t4vsop" style="font-size: 24px;">info</span> <div><strong class="svelte-t4vsop">Primera vez en el sistema</strong> <p class="svelte-t4vsop">Por seguridad, debes cambiar tu contraseña temporal por una personalizada.</p></div></div>'),xa=x('<div class="page-shell svelte-t4vsop"><div class="shape shape-a svelte-t4vsop" aria-hidden="true"></div> <div class="shape shape-b svelte-t4vsop" aria-hidden="true"></div> <section class="card svelte-t4vsop"><header class="card-head svelte-t4vsop"><p class="eyebrow svelte-t4vsop">Seguridad</p> <h1 class="svelte-t4vsop">Cambiar contraseña</h1> <!></header> <!> <form class="form svelte-t4vsop"><label class="field svelte-t4vsop"><span>Contraseña actual</span> <div class="input-wrap svelte-t4vsop"><input placeholder="••••••••" autocomplete="current-password" required class="svelte-t4vsop"/> <button type="button" class="eye svelte-t4vsop" aria-label="Mostrar u ocultar contraseña actual"><span class="ms-icon"> </span></button></div></label> <label class="field svelte-t4vsop"><span>Nueva contraseña</span> <div class="input-wrap svelte-t4vsop"><input placeholder="••••••••" autocomplete="new-password" required class="svelte-t4vsop"/> <button type="button" class="eye svelte-t4vsop" aria-label="Mostrar u ocultar nueva contraseña"><span class="ms-icon"> </span></button></div></label> <label class="field svelte-t4vsop"><span>Confirmar contraseña</span> <div class="input-wrap svelte-t4vsop"><input placeholder="Repite la contraseña" autocomplete="new-password" required class="svelte-t4vsop"/> <button type="button" class="eye svelte-t4vsop" aria-label="Mostrar u ocultar confirmación"><span class="ms-icon"> </span></button></div></label> <button class="primary svelte-t4vsop" type="submit"> </button></form></section></div>');function Ta(Q,U){la(U,!1);const C=()=>fa(O,"$auth",V),[V,X]=ba();let p=v(""),l=v(""),c=v(""),f=v(!1),_=v(!1),h=v(!1),n=v(!1);async function Y(s){if(s.preventDefault(),!a(p)||!a(l)||!a(c)){b("Completa todos los campos","warning");return}if(a(l)!==a(c)){b("Las contraseñas no coinciden","warning");return}if(a(l).length<6){b("La nueva contraseña debe tener al menos 6 caracteres","warning");return}o(n,!0);try{const i=C()?.usuario?.id_usuario;await _a.cambiarContraseña(a(p),a(l),i),O.update(L=>({...L,usuario:L.usuario?{...L.usuario,requiere_cambio_contrasena:!1}:null})),b("Contraseña actualizada exitosamente","success"),o(p,""),o(l,""),o(c,""),setTimeout(()=>{ha("/")},1500)}catch(i){b(i.message||"Error al cambiar la contraseña","error")}finally{o(n,!1)}}ma();var q=xa();ua("t4vsop",s=>{pa(()=>{ca.title="Cambiar contraseña - TransConecta"})});var I=r(e(q),4),$=e(I),Z=r(e($),4);{var aa=s=>{var i=ya();y(s,i)},sa=s=>{var i=wa();y(s,i)};K(Z,s=>{C()?.usuario?.requiere_cambio_contrasena?s(aa):s(sa,!1)})}t($);var R=r($,2);{var ea=s=>{var i=ga();y(s,i)};K(R,s=>{C()?.usuario?.requiere_cambio_contrasena&&s(ea)})}var z=r(R,2),k=e(z),W=r(e(k),2),u=e(W);P(u);var D=r(u,2),j=e(D),ta=e(j,!0);t(j),t(D),t(W),t(k);var M=r(k,2),B=r(e(M),2),d=e(B);P(d);var N=r(d,2),F=e(N),ra=e(F,!0);t(F),t(N),t(B),t(M);var S=r(M,2),H=r(e(S),2),m=e(H);P(m);var A=r(m,2),J=e(A),oa=e(J,!0);t(J),t(A),t(H),t(S);var G=r(S,2),ia=e(G,!0);t(G),t(z),t(I),t(q),na(()=>{T(u,"type",a(f)?"text":"password"),u.disabled=a(n),g(ta,a(f)?"visibility":"visibility_off"),T(d,"type",a(_)?"text":"password"),d.disabled=a(n),g(ra,a(_)?"visibility":"visibility_off"),T(m,"type",a(h)?"text":"password"),m.disabled=a(n),g(oa,a(h)?"visibility":"visibility_off"),G.disabled=a(n),g(ia,a(n)?"Guardando...":"Guardar cambios")}),E(u,()=>a(p),s=>o(p,s)),w("click",D,()=>o(f,!a(f))),E(d,()=>a(l),s=>o(l,s)),w("click",N,()=>o(_,!a(_))),E(m,()=>a(c),s=>o(c,s)),w("click",A,()=>o(h,!a(h))),w("submit",z,da(Y)),y(Q,q),va(),X()}export{Ta as component};
